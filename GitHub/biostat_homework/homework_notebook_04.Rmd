---
title: "automatization_notebook_04"
output: word_document
date: "`r Sys.Date()`"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)

```

# Чтение данных

В вашем варианте нужно использовать датасет healthcare-dataset-stroke-data.

```{r}
setwd('/Users/user/Desktop/BioStat_2023/biostat_homework/data/raw')
df<-readr::read_csv('/Users/user/Desktop/BioStat_2023/biostat_homework/data/raw/healthcare-dataset-stroke-data.csv')
df

```

# Выведите общее описание данных

```{r}
View(df)
dim(df)
```
```{r}
df %>%
  glimpse()
```

# Очистка данных

1) Уберите переменные, в которых пропущенных значений больше 20% или уберите субъектов со слишком большим количеством пропущенных значений. Или совместите оба варианта. Напишите обоснование, почему вы выбрали тот или иной вариант:

**Обоснование**: 

2) Переименуйте переменные в человекочитаемый вид (что делать с пробелами в названиях?);

3) В соответствии с описанием данных приведите переменные к нужному типу (numeric или factor);

4) Отсортируйте данные по возрасту по убыванию;

5) Сохраните в файл outliers.csv субъектов, которые являются выбросами (например, по правилу трёх сигм) — это необязательное задание со звёздочкой;

6) Присвойте получившийся датасет переменной "cleaned_data".

```{r}
head(complete.cases(df))
sum(complete.cases(df))
sum(!complete.cases(df))
sort(df$age, decreasing = FALSE)
```
```{r}
n<-c(rowSums(is.na(df)))
sort(n, decreasing = TRUE)
```
# Сколько осталось переменных?
```{r}
colSums((is.na(df)))

colSums(df == 'N/A')
typeof(df)
length(df[['BMI']])
```
##2) Переименуйте переменные в человекочитаемый вид (что делать с пробелами в названиях?);
```{r}
colnames(df) <- c('ID', 'Gender', 'Age', 'Hypertension', 'Heart disease', 'Ever married', 'Work type', 'Residence type', 'Avg glucose level', 'BMI', 'Smoking status', 'Stroke')
df
```


```{r}
a <- data.frame(df)
a[a['BMI'] != 'N/A',]
typeof(a)
```

# Сколько осталось случаев?
#в нашем дата фрейме нет пропущенных значений, у нас везде что-то написано

# Есть ли в данных идентичные строки?
#Нет
```{r}
duplicated(a)
```


```{r}
arrange(a, desc(a$Age)) -> cleaned_data
typeof(cleaned_data)
b <- data.frame(cleaned_data)
length(b[['Stroke']])
typeof(b)
```
```
# Сколько всего переменных с пропущенными значениями в данных и сколько пропущенных точек в каждой такой переменной?
#4909

# Описательные статистики

## Количественные переменные

1) Рассчитайте для всех количественных переменных для каждой группы (stroke):

1.1) Количество значений;

1.2) Количество пропущенных значений;

1.3) Среднее;

1.4) Медиану;

1.5) Стандартное отклонение;

1.6) 25% квантиль и 75% квантиль;

1.7) Интерквартильный размах;

1.8) Минимум;

1.9) Максимум;

1.10) 95% ДИ для среднего - задание со звёздочкой.

```{r}
length(b[['Stroke']])
##у меня вообще не полачется сдеалать анлист и у меня не считаются данные

```


## Категориальные переменные

1) Рассчитайте для всех категориальных переменных для каждой группы (stroke):

1.1) Абсолютное количество;

1.2) Относительное количество внутри группы;

1.3) 95% ДИ для доли внутри группы - задание со звёздочкой.

```{r}

```

# Визуализация

## Количественные переменные

1) Для каждой количественной переменной сделайте боксплоты по группам. Расположите их либо на отдельных рисунках, либо на одном, но читаемо;

2) Наложите на боксплоты beeplots - задание со звёздочкой.

3) Раскрасьте боксплоты с помощью библиотеки RColorBrewer.

```{r}



```

## Категориальные переменные

1) Сделайте подходящие визуализации категориальных переменных. Обоснуйте, почему выбрали именно этот тип.

```{r}



```


# Статистические оценки

## Проверка на нормальность

1) Оцените каждую переменную на соответствие нормальному распределению с помощью теста Шапиро-Уилка. Какие из переменных являются нормальными и как как вы это поняли?

```{r}



```

2) Постройте для каждой количественной переменной QQ-плот. Отличаются ли выводы от теста Шапиро-Уилка? Какой метод вы бы предпочли и почему?

```{r}



```

3) Ниже напишите, какие ещё методы проверки на нормальность вы знаете и какие у них есть ограничения.

**Напишите текст здесь**


## Сравнение групп

1) Сравните группы (переменная **stroke**) по каждой переменной (как количественной, так и категориальной). Для каждой переменной выберите нужный критерий и кратко обоснуйте его выбор в комментариях.

```{r}



```

# Далее идут **необязательные** дополнительные задания, которые могут принести вам дополнительные баллы в том числе в случае ошибок в предыдущих

## Корреляционный анализ

1) Создайте корреляционную матрицу с визуализацией и поправкой на множественные сравнения. Объясните, когда лучше использовать корреляционные матрицы и в чём минусы и плюсы корреляционных исследований.

```{r}



```

## Моделирование

1) Постройте регрессионную модель для переменной **stroke**. Опишите процесс построения

```{r}



```




